<script>
window.addEventListener('DOMContentLoaded', () => {
  const openBtn    = document.getElementById('openBtn');
  const calcBtn    = document.getElementById('calcBtn');
  const filePathP  = document.getElementById('filePath');
  const resultSpan = document.getElementById('result');
  const rpmInput   = document.getElementById('rpmMax');
  const modeSelect = document.getElementById('modeSelect');

  let currentFile = null;

  openBtn.addEventListener('click', async () => {
    const path = await window.api.selectFile();
    if (path) {
      currentFile    = path;
      filePathP.textContent = path;
      calcBtn.disabled      = false;
    }
  });

  calcBtn.addEventListener('click', async () => {
    if (!currentFile) return;
    // 1) Leggi il contenuto del file
    const text    = await window.api.readFile(currentFile);
    // 2) Prepara i parametri
    const rpmMax  = parseFloat(rpmInput.value) || Infinity;
    const mode    = modeSelect.value;           // 'lathe' o 'mill'
    // 3) Chiedi al main di calcolare il tempo
    const sec     = await window.api.calcTime({ text, mode, rpmMax });
    // 4) Mostra il risultato
    resultSpan.textContent = sec.toFixed(1);
  });
});
</script>
